(function () {var la=function(){},b={},h=[],N=[];function a(e,t){var r,o,n,$,a=N;for($=arguments.length;$-->2;)h.push(arguments[$]);for(t&&null!=t.children&&(h.length||h.push(t.children),delete t.children);h.length;)if((o=h.pop())&&void 0!==o.pop)for($=o.length;$--;)h.push(o[$]);else"boolean"==typeof o&&(o=null),(n="function"!=typeof e)&&(null==o?o="":"number"==typeof o?o=String(o):"string"!=typeof o&&(n=!1)),n&&r?a[a.length-1]+=o:a===N?a=[o]:a.push(o),r=n;var m=new la;return m.nodeName=e,m.children=a,m.attributes=null==t?void 0:t,m.key=null==t?void 0:t.key,void 0!==b.vnode&&b.vnode(m),m}function g(e,t){for(var r in t)e[r]=t[r];return e}var ja="function"==typeof Promise?Promise.resolve().then.bind(Promise.resolve()):setTimeout;function T(e,t){return a(e.nodeName,g(g({},e.attributes),t),arguments.length>2?[].slice.call(arguments,2):e.children)}var ga=/acit|ex(?:s|g|n|p|$)|rph|ows|mnc|ntw|ine[ch]|zoo|^ord/i,r=[];function F(e){!e._dirty&&(e._dirty=!0)&&1==r.push(e)&&(b.debounceRendering||ja)(o)}function o(){var e,t=r;for(r=[];e=t.pop();)e._dirty&&z(e)}function U(e,t,r){return"string"==typeof t||"number"==typeof t?void 0!==e.splitText:"string"==typeof t.nodeName?!e._componentConstructor&&J(e,t.nodeName):r||e._componentConstructor===t.nodeName}function J(e,t){return e.normalizedNodeName===t||e.nodeName.toLowerCase()===t.toLowerCase()}function L(e){var t=g({},e.attributes);t.children=e.children;var r=e.nodeName.defaultProps;if(void 0!==r)for(var o in r)void 0===t[o]&&(t[o]=r[o]);return t}function ea(e,t){var r=t?document.createElementNS("http://www.w3.org/2000/svg",e):document.createElement(e);return r.normalizedNodeName=e,r}function x(e){var t=e.parentNode;t&&t.removeChild(e)}function O(e,t,r,o,n){if("className"===t&&(t="class"),"key"===t);else if("ref"===t)r&&r(null),o&&o(e);else if("class"!==t||n){if("style"===t){if(o&&"string"!=typeof o&&"string"!=typeof r||(e.style.cssText=o||""),o&&"object"==typeof o){if("string"!=typeof r)for(var $ in r)$ in o||(e.style[$]="");for(var $ in o)e.style[$]="number"==typeof o[$]&&!1===ga.test($)?o[$]+"px":o[$]}}else if("dangerouslySetInnerHTML"===t)o&&(e.innerHTML=o.__html||"");else if("o"==t[0]&&"n"==t[1]){var a=t!==(t=t.replace(/Capture$/,""));t=t.toLowerCase().substring(2),o?r||e.addEventListener(t,P,a):e.removeEventListener(t,P,a),(e._listeners||(e._listeners={}))[t]=o}else if("list"!==t&&"type"!==t&&!n&&t in e){try{e[t]=null==o?"":o}catch(i){}null!=o&&!1!==o||"spellcheck"==t||e.removeAttribute(t)}else{var m=n&&t!==(t=t.replace(/^xlink:?/,""));null==o||!1===o?m?e.removeAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase()):e.removeAttribute(t):"function"!=typeof o&&(m?e.setAttributeNS("http://www.w3.org/1999/xlink",t.toLowerCase(),o):e.setAttribute(t,o))}}else e.className=o||""}function P(e){return this._listeners[e.type](b.event&&b.event(e)||e)}var Q=[],B=0,k=!1,u=!1;function D(){for(var e;e=Q.pop();)b.afterMount&&b.afterMount(e),e.componentDidMount&&e.componentDidMount()}function E(e,t,r,o,n,$){B++||(k=null!=n&&void 0!==n.ownerSVGElement,u=null!=e&&!("__preactattr_"in e));var a=y(e,t,r,o,$);return n&&a.parentNode!==n&&n.appendChild(a),--B||(u=!1,$||D()),a}function y(e,t,r,o,n){var $=e,a=k;if(null!=t&&"boolean"!=typeof t||(t=""),"string"==typeof t||"number"==typeof t)return e&&void 0!==e.splitText&&e.parentNode&&(!e._component||n)?e.nodeValue!=t&&(e.nodeValue=t):($=document.createTextNode(t),e&&(e.parentNode&&e.parentNode.replaceChild($,e),j(e,!0))),$.__preactattr_=!0,$;var m=t.nodeName;if("function"==typeof m)return X(e,t,r,o);if(k="svg"===m||"foreignObject"!==m&&k,m=String(m),(!e||!J(e,m))&&($=ea(m,k),e)){for(;e.firstChild;)$.appendChild(e.firstChild);e.parentNode&&e.parentNode.replaceChild($,e),j(e,!0)}var i=$.firstChild,p=$.__preactattr_,s=t.children;if(null==p){p=$.__preactattr_={};for(var l=$.attributes,v=l.length;v--;)p[l[v].name]=l[v].value}return!u&&s&&1===s.length&&"string"==typeof s[0]&&null!=i&&void 0!==i.splitText&&null==i.nextSibling?i.nodeValue!=s[0]&&(i.nodeValue=s[0]):(s&&s.length||null!=i)&&da($,s,r,o,u||null!=p.dangerouslySetInnerHTML),aa($,t.attributes,p),k=a,$}function da(e,t,r,o,n){var $,a,m,i,p,s=e.childNodes,l=[],v={},d=0,c=0,u=s.length,A=0,O=t?t.length:0;if(0!==u)for(var K=0;K<u;K++){var f=s[K],_=f.__preactattr_;null!=(h=O&&_?f._component?f._component.__key:_.key:null)?(d++,v[h]=f):(_||(void 0!==f.splitText?!n||f.nodeValue.trim():n))&&(l[A++]=f)}if(0!==O)for(K=0;K<O;K++){var h;if(p=null,null!=(h=(i=t[K]).key))d&&void 0!==v[h]&&(p=v[h],v[h]=void 0,d--);else if(c<A)for($=c;$<A;$++)if(void 0!==l[$]&&U(a=l[$],i,n)){p=a,l[$]=void 0,$===A-1&&A--,$===c&&c++;break}p=y(p,i,r,o),m=s[K],p&&p!==e&&p!==m&&(null==m?e.appendChild(p):p===m.nextSibling?x(m):e.insertBefore(p,m))}if(d)for(var K in v)void 0!==v[K]&&j(v[K],!1);for(;c<=A;)void 0!==(p=l[A--])&&j(p,!1)}function j(e,t){var r=e._component;r?w(r):(null!=e.__preactattr_&&e.__preactattr_.ref&&e.__preactattr_.ref(null),!1!==t&&null!=e.__preactattr_||x(e),C(e))}function C(e){for(e=e.lastChild;e;){var t=e.previousSibling;j(e,!0),e=t}}function aa(e,t,r){var o;for(o in r)t&&null!=t[o]||null==r[o]||O(e,o,r[o],r[o]=void 0,k);for(o in t)"children"===o||"innerHTML"===o||o in r&&t[o]===("value"===o||"checked"===o?e[o]:r[o])||O(e,o,r[o],r[o]=t[o],k)}var i=[];function G(e,t,r){var o,n=i.length;for(e.prototype&&e.prototype.render?(o=new e(t,r),p.call(o,t,r)):((o=new p(t,r)).constructor=e,o.render=Y);n--;)if(i[n].constructor===e)return o.nextBase=i[n].nextBase,i.splice(n,1),o;return o}function Y(e,t,r){return this.constructor(e,r)}function q(e,t,r,o,n){e._disable||(e._disable=!0,e.__ref=t.ref,e.__key=t.key,delete t.ref,delete t.key,void 0===e.constructor.getDerivedStateFromProps&&(!e.base||n?e.componentWillMount&&e.componentWillMount():e.componentWillReceiveProps&&e.componentWillReceiveProps(t,o)),o&&o!==e.context&&(e.prevContext||(e.prevContext=e.context),e.context=o),e.prevProps||(e.prevProps=e.props),e.props=t,e._disable=!1,0!==r&&(1!==r&&!1===b.syncComponentUpdates&&e.base?F(e):z(e,1,n)),e.__ref&&e.__ref(e))}function z(e,t,r,o){if(!e._disable){var n,$,a,m=e.props,i=e.state,p=e.context,s=e.prevProps||m,l=e.prevState||i,v=e.prevContext||p,d=e.base,c=e.nextBase,u=d||c,A=e._component,O=!1,K=v;if(e.constructor.getDerivedStateFromProps&&(i=g(g({},i),e.constructor.getDerivedStateFromProps(m,i)),e.state=i),d&&(e.props=s,e.state=l,e.context=v,2!==t&&e.shouldComponentUpdate&&!1===e.shouldComponentUpdate(m,i,p)?O=!0:e.componentWillUpdate&&e.componentWillUpdate(m,i,p),e.props=m,e.state=i,e.context=p),e.prevProps=e.prevState=e.prevContext=e.nextBase=null,e._dirty=!1,!O){n=e.render(m,i,p),e.getChildContext&&(p=g(g({},p),e.getChildContext())),d&&e.getSnapshotBeforeUpdate&&(K=e.getSnapshotBeforeUpdate(s,l));var f,_,h=n&&n.nodeName;if("function"==typeof h){var x=L(n);($=A)&&$.constructor===h&&x.key==$.__key?q($,x,1,p,!1):(f=$,e._component=$=G(h,x,p),$.nextBase=$.nextBase||c,$._parentComponent=e,q($,x,0,p,!1),z($,1,r,!0)),_=$.base}else a=u,(f=A)&&(a=e._component=null),(u||1===t)&&(a&&(a._component=null),_=E(a,n,p,r||!d,u&&u.parentNode,!0));if(u&&_!==u&&$!==A){var C=u.parentNode;C&&_!==C&&(C.replaceChild(_,u),f||(u._component=null,j(u,!1)))}if(f&&w(f),e.base=_,_&&!o){for(var N=e,y=e;y=y._parentComponent;)(N=y).base=_;_._component=N,_._componentConstructor=N.constructor}}for(!d||r?Q.unshift(e):O||(e.componentDidUpdate&&e.componentDidUpdate(s,l,K),b.afterUpdate&&b.afterUpdate(e));e._renderCallbacks.length;)e._renderCallbacks.pop().call(e);B||o||D()}}function X(e,t,r,o){for(var n=e&&e._component,$=n,a=e,m=n&&e._componentConstructor===t.nodeName,i=m,p=L(t);n&&!i&&(n=n._parentComponent);)i=n.constructor===t.nodeName;return n&&i&&(!o||n._component)?(q(n,p,3,r,o),e=n.base):($&&!m&&(w($),e=a=null),n=G(t.nodeName,p,r),e&&!n.nextBase&&(n.nextBase=e,a=null),q(n,p,1,r,o),e=n.base,a&&e!==a&&(a._component=null,j(a,!1))),e}function w(e){b.beforeUnmount&&b.beforeUnmount(e);var t=e.base;e._disable=!0,e.componentWillUnmount&&e.componentWillUnmount(),e.base=null;var r=e._component;r?w(r):t&&(t.__preactattr_&&t.__preactattr_.ref&&t.__preactattr_.ref(null),e.nextBase=t,x(t),i.push(e),C(t)),e.__ref&&e.__ref(null)}function p(e,t){this._dirty=!0,this.context=t,this.props=e,this.state=this.state||{},this._renderCallbacks=[]}function n(e,t,r){return E(r,e,{},!1,t,!1)}g(p.prototype,{setState:function(e,t){this.prevState||(this.prevState=this.state),this.state=g(g({},this.state),"function"==typeof e?e(this.state,this.props):e),t&&this._renderCallbacks.push(t),F(this)},forceUpdate:function(e){e&&this._renderCallbacks.push(e),z(this,2)},render:function(){}});var W={h:a,createElement:a,cloneElement:T,Component:p,render:n,rerender:o,options:b};W,b,o,n,p,T,a,a;var m={};var fa;function V(t){return(V="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function t(n){return typeof n}:function t(n){return n&&"function"==typeof Symbol&&n.constructor===Symbol&&n!==Symbol.prototype?"symbol":typeof n})(t)}function l(){return fa}function e(t){var n,o=t.name;return(n={},n[o]=function(){var n=this,e=[];return this.displayName=o,this.toString=function(){return"<"+o+" ... />"},this.componentDidMount=function(){return e.forEach(function(t){return t.mount&&t.mount()})},this.componentDidUpdate=function(){return e.forEach(function(t){return t.update&&t.update()})},this.componentWillUnmount=function(){return e.forEach(function(t){return t.unmount&&t.unmount()})},this.shouldComponentUpdate=function(t){return Z(n.props,t)},this.addEffect=function(t){return e.push(t)},fa=this,this.render=t.call(this),fa=null,this.render.apply(this)},n)[o]}function R(t,n){return Object.keys(t).map(function(o){o in n||(n[o]=t[o])}),n}function v(t){var n=l();var o=function t(n){return null!=n?function(){return t.value[n]}:t.value};return o.value=R(t,n.props),n.componentWillReceiveProps=function(n){o.value=R(t,n)},o}function d(t){var n=l(),o=function t(o){return null==o?t.value:(t.value=o,new Promise(function(t){return n.forceUpdate(t)}))};return o.value=t,o}function c(t,n){var o=l(),e=V(t),r=Array.isArray(t);if("object"!==e||r){var u,c=t;null==n&&"function"===e&&(n=t,c=null);var $=function t(){return u&&u()},f=function t(){return u=n()||null};if("boolean"===e&&!t||r&&0==t.length)o.addEffect({mount:f,unmount:$});else{var i=function t(){return c.map(function(t){return t()})},p=!!c,a=p&&i();o.addEffect({mount:f,unmount:$,update:function t(){if(p){var n=i(),o=n.filter(function(t,n){return t!=a[n]});if(a=n,0==o.length)return}$(),f()}})}}else o.addEffect(t)}function Z(r,t){for(var f in r)if(!(f in t))return!0;for(var f in t)if(r[f]!==t[f])return!0;return!1}l,e,v,d,c;function _(o){return(_="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function o(t){return typeof t}:function o(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(o)}function s(){var o=[],t=!1;return l().addEffect({unmount:function t(){return o=null}}),function(e){if(o){var n=_(e);return"string"===n||"number"===n?(t=!0,function(t){if(o){if(null==t)return delete o[e],void o.length--;o.length++,o[e]=t}}):null==e?t?o:o[0]:void(o[0]=e)}}}s;var ba=m&&m.__awaiter||function(e,o,t,r){return new(t||(t=Promise))(function(n,l){function $(e){try{f(r.next(e))}catch(o){l(o)}}function i(e){try{f(r.throw(e))}catch(o){l(o)}}function f(e){e.done?n(e.value):new t(function(o){o(e.value)}).then($,i)}f((r=r.apply(e,o||[])).next())})},ca=m&&m.__generator||function(e,o){var t,r,n,l,$={label:0,sent:function e(){if(1&n[0])throw n[1];return n[1]},trys:[],ops:[]};return l={next:i(0),throw:i(1),return:i(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function i(l){return function(i){return function f(l){if(t)throw new TypeError("Generator is already executing.");for(;$;)try{if(t=1,r&&(n=2&l[0]?r.return:l[0]?r.throw||((n=r.return)&&n.call(r),0):r.next)&&!(n=n.call(r,l[1])).done)return n;switch(r=0,n&&(l=[2&l[0],n.value]),l[0]){case 0:case 1:n=l;break;case 4:return $.label++,{value:l[1],done:!1};case 5:$.label++,r=l[1],l=[0];continue;case 7:l=$.ops.pop(),$.trys.pop();continue;default:if(!(n=(n=$.trys).length>0&&n[n.length-1])&&(6===l[0]||2===l[0])){$=0;continue}if(3===l[0]&&(!n||l[1]>n[0]&&l[1]<n[3])){$.label=l[1];break}if(6===l[0]&&$.label<n[1]){$.label=n[1],n=l;break}if(n&&$.label<n[2]){$.label=n[2],$.ops.push(l);break}n[2]&&$.ops.pop(),$.trys.pop();continue;}l=o.call(e,$)}catch(i){l=[6,i],r=0}finally{t=n=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,i])}}},A=function e(o){return void 0===o&&(o=10),Array.from({length:Math.random()*o})},M=e(function e(){console.log("Factory phase ...",this);var o=v({defaultSuperProp:0}),t=d({superProp:o.value.defaultSuperProp});function r(e){return ba(this,void 0,void 0,function(){return ca(this,function(e){return t({superProp:t.value.superProp+1}).then(function(){return console.log("After click")}),[2]})})}c([t],function(){console.log("Click state update",t.value)});var n=d(5);function l(e){n(n.value-1)}c([n],function(){console.log("Other update",n())}),c(!1,function(){function e(){console.log("Subscribe effect // Window size changed",window.innerWidth)}return console.log("Subscribe effect // Start listening to resize events."),window.addEventListener("resize",e),function(){console.log("Subscribe effect // Stop listening to resize events."),window.removeEventListener("resize",e)}}),c(function(){return console.log("Every render effect // Mount and update"),function(){return console.log("Every render effect // Unmount")}}),c({mount:function e(){console.log("Lifecycle effect // Mount")},update:function e(){console.log("Lifecycle effect // Update")},unmount:function e(){console.log("Lifecycle effect // Unmount")}});var $=s();c([o("color")],function(){console.log("Color props updated to",o.value.color),console.log("Ref to color div :",$())});var i=d(A()),f=s();function u(){i(A())}return c([i],function(){console.log("List item refs :",f())}),function(){return console.log("Render phase ..."),a("div",{class:"HookedComponent"},a("h2",null,"Hooked Component"),a("p",null,"Color from props :"),a("div",{class:"HookedComponent_color",style:{background:o.value.color},children:o.value.color,key:o.value.color,ref:$}),a("hr",null),a("h3",null,"Click state"),a("p",null,"Value : ",t.value.superProp),a("button",{onClick:r},"Click me"),a("hr",null),a("h3",null,"Other state"),a("p",null,"Value : ",n()),a("button",{onClick:l},"Click me"),a("hr",null),a("h3",null,"List refs"),a("p",null,"This part shows how we can multi-ref DOM elements (or components)."),a("button",{onClick:u},"Update number of items"),a("ul",null,i().map(function(e,o){return a("li",{ref:f(o)},"Item n\xB0",o)})),a("hr",null),o.value.children,a("hr",null),a("h3",null,"Callback"),a("p",null,"This will remove this component from the DOM by calling a prop callback.",a("br",null),"This is meant to test detach effects."),a("button",{onClick:o.value.onDetach},"Detach this component"))}});m.default=M;var I=function(){return{width:window.innerWidth,height:window.innerHeight}};function t(){var e=d(I());function i(){e(I())}return c({mount:function(){return window.addEventListener("resize",i)},unmount:function(){return window.removeEventListener("resize",i)}}),e}var ha=e(function $(){var e=t();return function(){return a("div",null,a("h3",null,"Custom hook usage 1"),a("p",null,"Window width : ",e.value.width),a("p",null,"Window height : ",e.value.height))}});var ia=e(function r(){var e=t(),o=v({color:"black"});return function(){var r=e.value,$=r.width,l=r.height;return a("div",null,a("h3",null,"Custom hook usage 2"),a("div",{style:{margin:"0 auto",width:.2*$,height:.2*l,border:"2px solid grey",backgroundColor:o.value.color,borderRadius:2}}))}});var S=function o(){return"#"+Math.floor(16777215*Math.random()).toString(16)},ka=e(function o(){var n=d(!0),$=d(S()),e=Math.floor(100*Math.random());return function(){return a("div",{class:"App"},a("h1",null,"Hello Prehook \uD83D\uDE80"),a("p",null,"Open dev console and check source code to know more."),n()?a("div",null,a("h3",null,"Props with hooked components"),a("p",null,"This example will show update cycle when updating props of an hooked component."),a("button",{onClick:function o(n){return $(S())}},"Change color on HookedComponent"),a(M,{defaultSuperProp:e,color:$.value,onDetach:function o(){return n(!1)}},a(ha,null),a("hr",null),a(ia,{color:$.value}))):a("button",{onClick:function o($){return n(!0)},children:"Re-attach a new instance of HookedComponent"}))}});var f,K,$,ma,na,oa;var H=document.getElementById("app");n(a(ka,null),H,H.lastChild);})();